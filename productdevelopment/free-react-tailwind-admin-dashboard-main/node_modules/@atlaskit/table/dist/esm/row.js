import _slicedToArray from "@babel/runtime/helpers/slicedToArray";
import React, { memo, useMemo } from 'react';
import { useSelection } from './hooks/selection-provider';
import useExpand from './hooks/use-expand';
import useExpandContent from './hooks/use-expand-content';
import { useRowId } from './hooks/use-row-id';
import { useTable } from './hooks/use-table';
import { useTableBody } from './hooks/use-table-body';
import SelectableCell from './selectable-cell';
import { SelectableCell as SelectableCellPrimitive } from './ui/selectable-cell';
import { TR as TRPrimitive } from './ui/tr';
/**
 * __Row__
 *
 * A table row.
 *
 * - [Examples](https://atlassian.design/components/table/examples)
 */
var Row = /*#__PURE__*/memo(function (_ref) {
  var children = _ref.children,
    testId = _ref.testId;
  // To ensure valid nesting
  useTableBody();
  // to access table state
  var _useTable = useTable(),
    isSelectable = _useTable.isSelectable;
  var _useSelection = useSelection(),
    _useSelection2 = _slicedToArray(_useSelection, 1),
    _useSelection2$ = _useSelection2[0],
    allChecked = _useSelection2$.allChecked,
    checked = _useSelection2$.checked;
  var _useExpand = useExpand(),
    isExpanded = _useExpand.isExpanded;
  var _useExpandContent = useExpandContent(),
    isExpandableContent = _useExpandContent.isExpandableContent;
  var rowId = useRowId();
  var isSelected = useMemo(function () {
    if (!isSelectable || rowId === undefined) {
      return undefined;
    }
    return allChecked || checked.includes(rowId);
  }, [allChecked, checked, isSelectable, rowId]);
  if (isExpanded === false && isExpandableContent) {
    return null;
  }
  var selectableCell = isSelectable && /*#__PURE__*/React.createElement(SelectableCell, null);
  if (isSelectable && isExpandableContent) {
    selectableCell = /*#__PURE__*/React.createElement(SelectableCellPrimitive, {
      as: "td"
    });
  }
  return /*#__PURE__*/React.createElement(TRPrimitive, {
    isSelected: isSelected,
    testId: testId,
    isSubitem: isExpandableContent
  }, selectableCell, children);
});
export default Row;